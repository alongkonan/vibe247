<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIBE 24 - คลื่นเพลงฮิต...ต่อเนื่อง 24 ชั่วโมง</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:ital,wght@0,300;0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Prompt', sans-serif;
            background-color: #000000;
            color: #ffffff;
            overflow-x: hidden;
        }

        /* CI Colors */
        .text-vibe-red { color: #E31E24; }
        .bg-vibe-red { background-color: #E31E24; }
        .border-vibe-red { border-color: #E31E24; }
        .hover-text-vibe-red:hover { color: #E31E24; }
        
        /* Custom Animations */
        @keyframes pulse-red {
            0% { box-shadow: 0 0 0 0 rgba(227, 30, 36, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(227, 30, 36, 0); }
            100% { box-shadow: 0 0 0 0 rgba(227, 30, 36, 0); }
        }

        @keyframes sound-wave {
            0% { height: 10px; }
            50% { height: 100%; }
            100% { height: 10px; }
        }

        .pulse-btn {
            animation: pulse-red 2s infinite;
        }

        .equalizer-bar {
            width: 6px;
            background: #E31E24;
            margin: 0 2px;
            border-radius: 99px;
            animation: sound-wave 1s ease-in-out infinite;
        }
        
        .glass-panel {
            background: rgba(30, 30, 30, 0.6);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #111;
        }
        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #E31E24;
        }
        
        .cd-spin {
            animation: spin 10s linear infinite;
        }
        .cd-paused {
            animation-play-state: paused;
        }
        @keyframes spin { 100% { -webkit-transform: rotate(360deg); transform:rotate(360deg); } }

    </style>
</head>
<body class="flex flex-col min-h-screen bg-[url('https://images.unsplash.com/photo-1516280440614-6697288d5d38?q=80&w=2070&auto=format&fit=crop')] bg-cover bg-center bg-no-repeat bg-fixed">
    
    <!-- Dark Overlay -->
    <div class="fixed inset-0 bg-black/80 z-0"></div>

    <!-- Main Content -->
    <div class="relative z-10 flex flex-col min-h-screen">
        
        <!-- Header -->
        <header class="w-full p-6 flex justify-between items-center glass-panel sticky top-0 z-50 border-b border-gray-800">
            <div class="flex items-center gap-4">
                <img src="https://img2.pic.in.th/1000074512.png" alt="VIBE 24 Logo" class="h-12 md:h-16 object-contain drop-shadow-[0_0_10px_rgba(255,255,255,0.2)]">
                <div class="hidden md:block">
                    <h1 class="text-2xl font-bold tracking-tighter leading-none">VIBE <span class="text-vibe-red">24</span></h1>
                    <p class="text-xs text-gray-400 tracking-wide">คลื่นเพลงฮิต...ต่อเนื่อง 24 ชั่วโมง</p>
                </div>
            </div>
            
            <div class="flex items-center gap-4">
                <div class="hidden md:flex items-center gap-2 px-3 py-1 rounded-full bg-red-900/20 border border-red-900/50">
                    <div class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></div>
                    <span class="text-xs font-semibold text-red-400">LIVE</span>
                </div>
                <button onclick="toggleVolume()" class="text-gray-300 hover:text-white transition p-2">
                    <i id="vol-icon" class="fas fa-volume-up text-xl"></i>
                </button>
            </div>
        </header>

        <!-- Main Player Section -->
        <main class="flex-grow flex flex-col items-center justify-center p-4 md:p-8 w-full max-w-6xl mx-auto">
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 w-full items-center">
                
                <!-- Left: Artwork & Visualizer -->
                <div class="flex flex-col items-center justify-center relative group">
                    <!-- Artwork Container -->
                    <div class="relative w-64 h-64 md:w-96 md:h-96 rounded-full border-4 border-gray-800 p-2 shadow-2xl bg-black/50 overflow-hidden">
                        <img id="track-artwork" src="https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=800&auto=format&fit=crop" 
                             class="w-full h-full object-cover rounded-full cd-spin cd-paused shadow-[0_0_30px_rgba(227,30,36,0.3)] transition-transform duration-700" 
                             alt="Album Art"
                             onerror="this.src='https://img2.pic.in.th/1000074512.png'">
                        
                        <!-- Center Hole for CD effect -->
                        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-8 h-8 bg-black rounded-full border-2 border-gray-700 z-10"></div>
                    </div>

                    <!-- Equalizer (Hidden when paused) -->
                    <div id="visualizer" class="flex items-end justify-center h-12 gap-1 mt-8 opacity-0 transition-opacity duration-300">
                        <div class="equalizer-bar" style="animation-duration: 0.8s; height: 40%"></div>
                        <div class="equalizer-bar" style="animation-duration: 1.2s; height: 70%"></div>
                        <div class="equalizer-bar" style="animation-duration: 0.5s; height: 30%"></div>
                        <div class="equalizer-bar" style="animation-duration: 0.9s; height: 80%"></div>
                        <div class="equalizer-bar" style="animation-duration: 1.1s; height: 50%"></div>
                        <div class="equalizer-bar" style="animation-duration: 0.7s; height: 90%"></div>
                        <div class="equalizer-bar" style="animation-duration: 1.0s; height: 60%"></div>
                        <div class="equalizer-bar" style="animation-duration: 0.6s; height: 40%"></div>
                    </div>
                </div>

                <!-- Right: Controls & Info -->
                <div class="flex flex-col space-y-6 text-center lg:text-left glass-panel p-8 rounded-2xl relative overflow-hidden">
                    <!-- Decorative background element -->
                    <div class="absolute top-0 right-0 -mt-10 -mr-10 w-40 h-40 bg-vibe-red blur-[100px] opacity-20 pointer-events-none"></div>

                    <div class="space-y-1">
                        <span class="inline-block px-3 py-1 rounded bg-gray-800 text-gray-400 text-xs font-bold tracking-widest uppercase mb-2">Now Playing</span>
                        <h2 id="track-title" class="text-3xl md:text-5xl font-bold leading-tight text-white drop-shadow-lg break-words">
                            Loading...
                        </h2>
                        <p id="artist-name" class="text-xl text-vibe-red font-medium">Please wait</p>
                    </div>

                    <!-- Controls -->
                    <div class="flex flex-col items-center lg:items-start gap-6 pt-4">
                        <div class="flex items-center gap-6">
                            <button id="play-btn" onclick="togglePlay()" class="w-20 h-20 md:w-24 md:h-24 rounded-full bg-white text-vibe-red hover:bg-vibe-red hover:text-white transition-all duration-300 flex items-center justify-center shadow-lg hover:shadow-[0_0_30px_rgba(227,30,36,0.6)] focus:outline-none">
                                <i id="play-icon" class="fas fa-play text-3xl md:text-4xl ml-2"></i>
                            </button>
                            
                            <!-- Volume Slider (Desktop) -->
                            <div class="hidden md:flex items-center gap-3 bg-black/40 rounded-full px-4 py-2 border border-gray-700">
                                <i class="fas fa-volume-down text-gray-400 text-xs"></i>
                                <input type="range" id="volume-slider" min="0" max="1" step="0.1" value="1" class="w-24 h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer accent-red-600">
                                <i class="fas fa-volume-up text-gray-400 text-xs"></i>
                            </div>
                        </div>
                        
                        <p class="text-sm text-gray-400 max-w-md">
                            กดปุ่ม Play เพื่อเริ่มฟังเพลงฮิตต่อเนื่อง 24 ชั่วโมง ความคมชัดระดับ HD
                        </p>
                    </div>

                    <div class="h-px w-full bg-gray-700/50 my-4"></div>

                    <!-- Next Track & Request -->
                    <div class="flex flex-col md:flex-row justify-between items-center gap-4 w-full">
                        <div class="text-center lg:text-left">
                            <p class="text-xs text-gray-500 uppercase font-bold mb-1">Coming Up Next</p>
                            <div class="flex items-center gap-2">
                                <i class="fas fa-forward text-gray-600 text-sm"></i>
                                <span id="next-track" class="text-gray-300 text-sm truncate max-w-[200px]">Loading...</span>
                            </div>
                        </div>
                        
                        <button onclick="openRequestModal()" class="group relative px-6 py-3 bg-transparent border border-gray-600 hover:border-vibe-red text-white rounded-lg transition-all duration-300 overflow-hidden">
                            <div class="absolute inset-0 w-0 bg-vibe-red transition-all duration-[250ms] ease-out group-hover:w-full opacity-10"></div>
                            <span class="relative flex items-center gap-2 font-medium">
                                <i class="fas fa-music text-vibe-red"></i> ขอเพลง
                            </span>
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="w-full p-6 text-center text-gray-600 text-sm glass-panel border-t border-gray-800">
            <p>&copy; 2024 VIBE 24 Radio. All rights reserved.</p>
            <div class="flex justify-center gap-4 mt-2">
                <a href="#" class="hover:text-vibe-red transition"><i class="fab fa-facebook"></i></a>
                <a href="#" class="hover:text-vibe-red transition"><i class="fab fa-instagram"></i></a>
                <a href="#" class="hover:text-vibe-red transition"><i class="fab fa-twitter"></i></a>
            </div>
        </footer>

    </div>

    <!-- Hidden Audio Element -->
    <audio id="radio-player" preload="none">
        <source src="https://streaming.radio.co/sbf4f79825/listen" type="audio/mpeg">
        Browser ของคุณไม่รองรับการเล่นเสียง
    </audio>

    <!-- Request Modal -->
    <div id="request-modal" class="fixed inset-0 z-[60] hidden">
        <!-- Backdrop -->
        <div class="absolute inset-0 bg-black/90 backdrop-blur-sm" onclick="closeRequestModal()"></div>
        
        <!-- Modal Content -->
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-4xl h-[600px] bg-[#1a1a1a] border border-gray-700 rounded-xl shadow-2xl flex flex-col overflow-hidden">
            <div class="flex justify-between items-center p-4 border-b border-gray-800 bg-black">
                <h3 class="text-xl font-bold text-white"><i class="fas fa-music text-vibe-red mr-2"></i> ขอเพลงฮิต (Request)</h3>
                <button onclick="closeRequestModal()" class="text-gray-400 hover:text-white transition">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="flex-grow bg-black relative">
                <!-- iframe embedding the Request URL based on the script logic -->
                <iframe src="https://embed.radio.co/request/w75f0bc0" class="w-full h-full border-0" title="Request Track"></iframe>
            </div>
        </div>
    </div>

    <script>
        // --- Configuration ---
        const STATION_ID = "sbf4f79825";
        const API_URL = `https://public.radio.co/stations/${STATION_ID}/status`;
        
        // --- Elements ---
        const player = document.getElementById('radio-player');
        const playBtn = document.getElementById('play-btn');
        const playIcon = document.getElementById('play-icon');
        const artworkImg = document.getElementById('track-artwork');
        const titleEl = document.getElementById('track-title');
        const artistEl = document.getElementById('artist-name');
        const nextTrackEl = document.getElementById('next-track');
        const visualizer = document.getElementById('visualizer');
        const volumeSlider = document.getElementById('volume-slider');
        const volIcon = document.getElementById('vol-icon');

        let isPlaying = false;

        // --- Core Functions ---

        function togglePlay() {
            if (player.paused) {
                // Play
                const playPromise = player.play();
                if (playPromise !== undefined) {
                    playPromise.then(_ => {
                        updatePlayState(true);
                    })
                    .catch(error => {
                        console.error("Auto-play prevented or stream error:", error);
                        alert("กรุณากดเล่นอีกครั้ง (Browser prevented autoplay)");
                    });
                }
            } else {
                // Pause
                player.pause();
                updatePlayState(false);
            }
        }

        function updatePlayState(playing) {
            isPlaying = playing;
            if (playing) {
                playIcon.classList.remove('fa-play');
                playIcon.classList.remove('ml-2'); // Remove play adjustment
                playIcon.classList.add('fa-pause');
                
                playBtn.classList.add('pulse-btn');
                artworkImg.classList.remove('cd-paused');
                visualizer.classList.remove('opacity-0');
            } else {
                playIcon.classList.remove('fa-pause');
                playIcon.classList.add('fa-play');
                playIcon.classList.add('ml-2'); // Add adjustment for play icon center
                
                playBtn.classList.remove('pulse-btn');
                artworkImg.classList.add('cd-paused');
                visualizer.classList.add('opacity-0');
            }
        }

        function toggleVolume() {
            player.muted = !player.muted;
            if(player.muted) {
                volIcon.classList.remove('fa-volume-up');
                volIcon.classList.add('fa-volume-mute');
                volIcon.classList.add('text-red-500');
            } else {
                volIcon.classList.remove('fa-volume-mute');
                volIcon.classList.add('fa-volume-up');
                volIcon.classList.remove('text-red-500');
            }
        }

        // Volume Slider Logic
        volumeSlider.addEventListener('input', (e) => {
            player.volume = e.target.value;
            player.muted = false;
        });

        // --- Fetch Metadata (The Modern Way) ---
        // Instead of using document.write scripts, we fetch JSON
        async function fetchRadioData() {
            try {
                const response = await fetch(API_URL);
                const data = await response.json();
                
                // Update UI
                const currentTrack = data.current_track;
                const nextTrack = data.next_track;
                const history = data.history;

                // Split Title - Artist (Usually format is "Artist - Title" or "Title")
                let songTitle = currentTrack.title;
                let artistName = "VIBE 24";

                if (songTitle.includes(" - ")) {
                    const parts = songTitle.split(" - ");
                    artistName = parts[0];
                    songTitle = parts.slice(1).join(" - ");
                }

                // Update Text with simple animation if changed
                if(titleEl.innerText !== songTitle) {
                    titleEl.innerText = songTitle;
                    artistEl.innerText = artistName;
                }
                
                // Update Artwork
                if (currentTrack.artwork_url && currentTrack.artwork_url !== artworkImg.src) {
                     // Check if it's the generic radio.co logo, maybe use our logo instead
                    if(currentTrack.artwork_url.includes("cdn.radio.co") && !currentTrack.artwork_url.includes("artworks")) {
                         // Keep default or set to station logo
                    } else {
                        artworkImg.src = currentTrack.artwork_url;
                    }
                }

                // Update Next Track
                nextTrackEl.innerText = nextTrack.title || "Coming up soon...";
                
                // Update document title
                document.title = `▶ ${songTitle} | VIBE 24`;

            } catch (error) {
                console.error("Error fetching radio data:", error);
                // Fail silently, keep old data
            }
        }

        // --- Modal Logic ---
        window.openRequestModal = function() {
            document.getElementById('request-modal').classList.remove('hidden');
        }

        window.closeRequestModal = function() {
            document.getElementById('request-modal').classList.add('hidden');
        }

        // --- Initialization ---
        // Fetch initially
        fetchRadioData();
        // Fetch every 10 seconds
        setInterval(fetchRadioData, 10000);

    </script>
</body>
</html>
